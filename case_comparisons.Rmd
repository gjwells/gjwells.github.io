---
title: "Village comparisons"
output:
  pdf_document: default
  word_document:
    reference_docx: default
  html_document: default
---

### Background

To help get a sense of the variation of contexts between sites, I have pulled together the locations of the villages across the different sites (exc. Tanzania and Malawi), and have generated descriptions using the following secondary spatial datasets:

* *Country*
* *Terrestrial, freshwater and marine ecoregions* (from TNC http://maps.tnc.org/gis_data.html)
* *Land cover type* in 2013 (from FAO http://www.fao.org/geonetwork/srv/en/main.home?uuid=ba4526fd-cdbf-4028-a1bd-5a559c4bff38)
* *Population* of subnational region in 2013 (from OPHI https://ophi.org.uk/2013-mpi-data-tables/; 2015 for Peru)
* *Poverty:* national and subnational regional global multi-dimensional poverty indices in 2013 (from OPHI https://ophi.org.uk/2013-mpi-data-tables/; 2015 for Peru)
* *Market access:* travel time to nearest city of 50k people in 2015 (from Weiss et al. https://map.ox.ac.uk/research-project/accessibility_to_cities/)
* *Human pressure on environment:* Human Footprint Index in 2009 (from Venter et al. https://sedac.ciesin.columbia.edu/data/set/wildareas-v3-2009-human-footprint)
* *Distance from protected area:* from 2019 (derived from IUCN/UNEP https://www.protectedplanet.net/)

We are waiting on spatial information for Tanzania (PIMA, 42 villages) and Malawi (ASSETS, 6 villages).
The locations for Colombia are also not quite right at the moment, but sufficient for this exercise.

Note that for the actual analysis we need to confirm the nature of the spatial boundaries we have for 
each site - do they relate to
village boundaries, resource areas? Also many of the spatial products are quite general,
so the following indicators should be considered very rough.

```{r setup,  message = FALSE, warning = FALSE, include=FALSE}
#### 1. R SETUP ----
## a) set wd if not already
#if (grepl("n4s_git", getwd()) == TRUE){setwd(choose.dir(getwd()))}

## b) check packages and install if needed
check.packages <- function(pkg){
      new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
      if (length(new.pkg))
          install.packages(new.pkg, dependencies = TRUE,repos = "http://cran.us.r-project.org")
  }
check.packages(c("ggplot2","knitr","QCA","xlsx","VIM","mice","Hmisc",
                 "grid","RColorBrewer","kableExtra","rgdal","raster","sp",
                 "rgeos","maps","sf"))

sapply(c("raster","rgdal","rgeos","maps","sf","lwgeom"),require,character.only=T)

## c) R markdown and knitr stuff
knitr::opts_chunk$set(echo = TRUE) ; knitr::opts_chunk$set(root.dir = getwd())
#options("scipen"=999)
#library(kableExtra)
```

```{r functions, message = FALSE, warning = FALSE, include=FALSE}
#### 2. FUNCTIONS ----

## a) get general functions
source('functions.R')

```

```{r data 1, message = FALSE, warning = FALSE, include=FALSE}
#### 3A. LOAD EXISTING SHAPEFILE ----

## a) load list of existing data and analysis

n4s_sp <- rgdal::readOGR(encoding="UTF-8", "../data/proc", # plot locations
                        "n4s_sp")
```

```{r data 2, message = FALSE, warning = FALSE, include=FALSE, eval=FALSE}
#### 3B. LOAD MAIN DATA ----

## b) get existing spatial files for each dataset

  # i) DELTAS
  load(file = "../data/proc/deltas.rda")
  de_sp <- deltas$de_spatial
  # distinguish some duplicate village names
  de_sp$MOUZA_NM <- as.character(de_sp$MOUZA_NM)
  de_sp$MOUZA_NM[59] <- "Chandulia B"
  de_sp$MOUZA_NM[63] <- "Khalisha Bunia B"

  # ii) P4GES
  load(file = "../data/proc/pages.rda")
  pa_sp <- pages$pa_spatial

  # iii)ACES
  load(file = "../data/proc/aces.rda")
  ac_sp <- aces$ac_spatial
  # align location names with mpi regions
  ac_sp@data$location <- factor(ac_sp@data$location,labels=c("Zambezia","Gaza","Niassa"))
  
  # iv) SPACES
  sp_sp <- rgdal::readOGR(encoding="UTF-8", "C:/n4s_local/sango/secondary_data/spaces", # plot locations
                        "space_approx_social_sites")
  
  # v) ASSETS
  # awaiting spatial information for Malawi
  # need to confrim UTM zones, and northing coords for Colombia
  as_sp <- xlsx::read.xlsx(encoding="UTF-8", "C:/n4s_local/sango/secondary_data/assets/ASSETS Site Locations.xlsx"
                    , sheetName="All", header=TRUE)
    
    # make shp for each country and convert to wgs
    tmp1 <- as_sp[as_sp$cn=="COL",] # colombia 
    coordinates(tmp1) <- ~easting + northing
    projection(tmp1) <- "+proj=utm +zone=19 +north +ellps=WGS84"
    tmp1 <- spTransform(tmp1, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
    tmp2 <- as_sp[as_sp$cn=="PER",] # peru 
    coordinates(tmp2) <- ~easting + northing
    projection(tmp2) <- "+proj=utm +zone=18 +south +ellps=WGS84"
    tmp2 <- spTransform(tmp2, CRS("+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"))
    
    # combine
    as_sp <- rbind(tmp1,tmp2)

  # vi) PIMA
  # awaiting spatial information
  pi_sp <- rgdal::readOGR(encoding="UTF-8", "C:/Users/gewe5964/Downloads/2012_ward_shapefiles/2012 Wards Shapefiles", # plot locations
                        "TZwards")

  # vii) Odisha
  od_sp <- rgdal::readOGR(encoding="UTF-8", "C:/n4s_local/sango/secondary_data/odisha", # plot locations
                        "PEFESPA site locations")

  # viii) Sentinal
  # awaiting spatial information

## c) get OPHI MPI data
# 2013 missing for Peru so addin 2015 for those sites.
# from https://ophi.org.uk/2013-mpi-data-tables/
mpi <- xlsx::read.xlsx(encoding="UTF-8", "C:/n4sdgs/r_analysis/data/raw/ophi/Tables_3_SubNational_Decomposition_2012_MPI_13_Mar_14_2013.xlsx"
                    , sheetName="3.1 Multidimensional Poverty ", header=TRUE, startRow=10)
mpi15 <- xlsx::read.xlsx(encoding="UTF-8", "C:/n4sdgs/r_analysis/data/raw/ophi/Tables_5_SubNational_Decomposition_MPI-20153.xlsx"
                    , sheetName="5.1 Multidimensional Poverty ", header=TRUE, startRow=10)
mpi15 <- mpi15[mpi15$ISO.country.code=="PER",] # get 2015 peru data
tmp <- intersect(names(mpi),names(mpi15)) # get shared cols
mpi <- rbind(mpi[, tmp], mpi15[, tmp])# bind 2015 data for Peru to mpi 2013
mpi$Sub.national.region <- as.character(mpi$Sub.national.region)
mpi$Sub.national.region[mpi$Sub.national.region=="Orissa"] <- "Odisha" # update Orissa region to Odisha
  
## d) get travel time to nearest city of 50,000 people
# from https://map.ox.ac.uk/research-project/accessibility_to_cities/
# Weiss 2018 https://www.nature.com/articles/nature25181
travel_t <- raster::raster("C:/n4s_local/sango/secondary_data/global/2015_accessibility_to_cities_v1.0/2015_accessibility_to_cities_v1.0.tif")

## e) get human footprint data 2018
# from https://sedac.ciesin.columbia.edu/data/set/wildareas-v3-2009-human-footprint
# Venter 2016 https://www.nature.com/articles/sdata201667
# Reprojected from Mollweide to latlong in QGIS
hfp <- raster::raster("C:/n4s_local/sango/secondary_data/global/wildareas-v3-2009-human-footprint-geotiff/wildareas-v3-2009-human-footprint_latlong.tif")

## f) world database of protected areas
# - from https://www.protectedplanet.net/
# - only approximate and we don't know how comprehensive
# - also they only have point locations for some parks and unclear if this is the
# centroid. Here is use a merged shapefile of polyongs and buffered points (0.01 degree width)
# - input file clipped to cover project areas (full file is massive)
pab <- rgdal::readOGR(encoding="UTF-8", "C:/n4s_local/sango/secondary_data/global/WDPA_Oct2019-shapefile", # plot locations
                        "wdpa_merged")

## g) terrestrial, freshwater and marine ecoregions
# from http://maps.tnc.org/gis_data.html
# combining shp files with habitat type or realm
# terrestrial
ter <- rgdal::readOGR(encoding="UTF-8", "C:/n4s_local/sango/secondary_data/global/terr-ecoregions-TNC", # plot locations
                        "tnc_terr_ecoregions")
ter@data <- data.frame(mht=ter@data$WWF_MHTNAM) # get habitat type
# freshwater
fer <- rgdal::readOGR(encoding="UTF-8", "C:/n4s_local/sango/secondary_data/global/FEOW-TNC", # plot locations
                        "FEOWv1_TNC")
fer@data <- data.frame(mht=fer@data$MHT_TXT) # get habitat type

# marine
mer <- rgdal::readOGR(encoding="UTF-8", "C:/n4s_local/sango/secondary_data/global/MEOW-TNC", # plot locations
                        "meow_ecos")
mer@data <- data.frame(mht=mer@data$REALM) # get realm type

## h) land cover
# from FAO: http://www.fao.org/geonetwork/srv/en/main.home?uuid=ba4526fd-cdbf-4028-a1bd-5a559c4bff38
lc <-  raster::raster("C:/n4s_local/sango/secondary_data/global/GlcShare_v10_Dominant/glc_shv10_DOM.tif")

# combine
er <- rbind(ter,fer,mer)

```

```{r combine, message = FALSE, warning = FALSE, include=FALSE, eval=FALSE}
#### 3. Harmonise and combine shp files and existing data ----

## aliging fields with follow categories. NA where no data.
# cn = country
# rg = sub-national region according to OPHI mpi dataset
# vl = village name (or unit closest to)
# rgpop = regional population size according to OPHI
# vlpop = village population size
# cnmpi = country level mpi from OPHI
# rgmpi = regional mpi from OPHI
# tt = travel time to nearest city of 50k (mins)
# hfp = human footprint index (1 is lowest, 100 is highest)

 ### a) align shp attributes

  # i) DELTAS
  de_sp@data <- data.frame(
    cn = rep("BGD",nrow(de_sp)),
    rg = de_sp$DIVISION_NM, # division
    vl = de_sp$MOUZA_NM, # mouza
    vlpop = NA,
    tt = de_sp$tt_mz,
    hfp = de_sp$hfp_mz
  )

  # ii) P4GES
  pa_sp@data <- data.frame(
    cn = rep("MDG",nrow(pa_sp)),
    rg = pa_sp$REGION, # REGION
    vl = pa_sp$FOKONTANY, # FOKONTANY
    vlpop = NA,
    tt = pa_sp$tt_vill,
    hfp = pa_sp$hfp_vill
  )

  # iii)ACES
  ac_sp@data <- data.frame(
    cn = rep("MOZ",nrow(ac_sp)),
    rg = ac_sp$location, # province
    vl = ac_sp$name, # village
    vlpop = NA,
    tt = ac_sp$tt_vill,
    hfp = ac_sp$hfp_vill
  )

  # iv) SPACES
  sp_sp@data <- data.frame(
    cn = c("MOZ","MOZ","MOZ","MOZ","KEN","KEN","KEN","KEN"),
    rg = c("Cabo Delgado","Cabo Delgado","Cabo Delgado","Cabo Delgado",
           "Coast","Coast","Coast","Coast"), # province
    vl = sp_sp$Name, # village
    vlpop = NA,
    tt = NA,
    hfp = NA
  )

  
  # v) ASSETS
  # awaiting spatial information for Malawi sites
  as_sp@data <- data.frame(
    cn = as_sp$cn,
    rg = as_sp$rg, # province
    vl = as_sp$vl, # village
    vlpop = NA,
    tt = NA,
    hfp = NA
  )
  

  # vi) PIMA
  # awaiting spatial information

  # vii) Odisha
  od_sp@data <- data.frame(
    cn = rep("IND",nrow(od_sp)),
    rg = rep("Odisha",nrow(od_sp)), # province
    vl = od_sp$SiteName, # village
    vlpop = NA,
    tt = NA,
    hfp = NA
  )
  
  # viii) Sentinal
  # awaiting spatial information

  ### b) combine and add id
  # - making points from ASSETS data small buffered circle (approx 1km) polygons so that we can combine all spatial files

  as_sp <- rgeos::gBuffer(as_sp,width=0.01,byid=T) # buffer ASSETS points
    
  n4s_sp <- rbind(de_sp,pa_sp,ac_sp,od_sp,sp_sp,as_sp) # combine polygon shps
  
  n4s_sp$vlid <- seq(1,nrow(n4s_sp)) # add n4S villiage id

  ## TO DO
  # - Deltas HFP looks strange. it has values of 128 but I think the max is 100...
  # - there are two duplicate village names in DELTAS is this ok?
  # - what do the boundaries mean for the different datasets? And ASSETS are only points.
  
```

```{r add_data, message = FALSE, warning = FALSE, include=FALSE,eval=FALSE}
#### 4. add data for missing fields ----

## a) regional population, country MPI and regional MPI (from MPI datasets)
n4s_sp@data <- merge(n4s_sp@data,
                     mpi[c("ISO.country.code","Sub.national.region",
                                       "Total.population.",
                                       "Multidimensional.Poverty.Index..MPI..of.the.country",
                                       "Multidimensional.Poverty.Index..MPI...H.A.")],
                     by.x=c("cn","rg"),by.y=c("ISO.country.code","Sub.national.region"),all.x=T)
names(n4s_sp@data)[(ncol(n4s_sp@data)-2):ncol(n4s_sp@data)] <- c("rgpop","cnmpi","rgmpi")


## b) add weiss travel time to ac_spatial for each village
# minutes to nearest town of 50,000

n4s_sp$tt <- NULL # remove existing values
tmp <- raster::crop(travel_t, n4s_sp) # cropping raster for sites
tmp[tmp<0] <- NA # replace -9999 with NAs
tmp <- raster::extract(tmp, n4s_sp,  fun=median, na.rm=TRUE, sp = T) # extract values
names(tmp@data)[ncol(tmp@data)] <- "tt" # rename
n4s_sp@data <- merge(n4s_sp@data,tmp@data[c("vlid","tt")],by=c("vlid"),all.x=T) # merge with main shp file

## c) add venter human footprint for each village
# 1 is low, 100 is high
n4s_sp$hfp <- NULL # remove existing values
tmp <- raster::crop(hfp, n4s_sp) # cropping raster for sites
tmp <- raster::extract(hfp, n4s_sp,  fun=median, na.rm=TRUE, sp = T) # extract values
names(tmp@data)[ncol(tmp@data)] <- "hfp" # rename
n4s_sp@data <- merge(n4s_sp@data,tmp@data[c("vlid","hfp")],by=c("vlid"),all.x=T) # merge with main shp file

## d) add ecozones
n4s_sp@data$er <- over(n4s_sp,er)$mht

## e) add distance to protected area
# doing by country and nearest feature, and with sf package, to help with processing time
# gives distance in meters. converted to kms
out <- data.frame(vlid=NULL,pad=NULL) # get empty df
for(i in as.character(unique(n4s_sp$cn))){
  tmp <- pab[pab$PARENT_ISO==i,] # subset by country
  ind <- st_nearest_feature(x = as(n4s_sp[n4s_sp$cn==i,],"sf"), # index nearest feature
                            y = as(tmp,"sf"))
  res <- st_distance(as(n4s_sp[n4s_sp$cn==i,],"sf"), # get distance from nearest feature
                     as(tmp[ind,],"sf"),by_element = T)
  out <- cbind(out,data.frame(vlid=n4s_sp$vlid[n4s_sp$cn==i], # bind to out df
                              pad=as.numeric(res)))
}
n4s_sp@data <- cbind(n4s_sp@data,out[2]) # add to shp file
n4s_sp$pad <- n4s_sp$pad/1000 # convert to kms

## f) add land cover class
# taking median dominant land cover class for area
n4s_sp$lc <- NULL # remove existing values
tmp <- raster::crop(lc, n4s_sp) # cropping raster for sites
tmp <- raster::extract(lc, n4s_sp,  fun= median, na.rm=TRUE, sp = T) # extract values
names(tmp@data)[ncol(tmp@data)] <- "lc" # rename
n4s_sp@data <- merge(n4s_sp@data,tmp@data[c("vlid","lc")],by=c("vlid"),all.x=T) # merge with main shp file
n4s_sp@data$lc[n4s_sp@data$lc==7.5] <- 3 # deal with 7.5. should be 3
n4s_sp@data$lc <- factor(n4s_sp@data$lc, levels=c(1:11), labels=c(  # make factor with labels
  "Artificial Surfaces", "CropLand", "Grassland", "Tree Covered Area",
  "Shrubs Covered Area", "Herbaceous vegetation, aquatic or regularly flooded", 
"Mangroves", "Sparse vegetation", "BareSoil", "Snow and glaciers", "Waterbodies"))

```

### Site locations
Our sites are located as follows:

```{r plots, message = FALSE, warning = FALSE, echo=FALSE,fig.width=15}

world_map <- map_data("world")
crds <- as.data.frame(coordinates(n4s_sp)) # site coordinates
ggplot(world_map, aes(x = long, y = lat, group = group)) + # world map
  geom_polygon(fill="lightgray", colour = "white") +
  geom_point(data=crds,aes(x=crds$V1, y=crds$V2,group=n4s_sp$cn, # site locs
                           col=n4s_sp$cn),size=4,alpha=0.3,pch=17) + 
  labs(colour = "Country") +
  coord_map(xlim = c(min(crds$V1)-5,max(crds$V1)+5),# crop map
            ylim = c(min(crds$V2)-5,max(crds$V2)+5)) + 
  theme_bw() +
  theme(plot.title = element_text(size = 10,face = "italic"), # plot themes
                       #legend.title=element_blank(),
                       axis.text=element_text(size=10),
                       panel.border = element_blank(), 
                       panel.grid.major = element_blank(),
                       panel.grid.minor = element_blank())
```

We have a total of 183 villages (or similar). The number in each country is as follows (not including Tanzania and Malawi):

```{r plots 2, message = FALSE, warning = FALSE, echo=FALSE}

summary(n4s_sp$cn)

```

### Ecoregions and land cover
Our villages span the followng broad ecoregions:

```{r plots 3, message = FALSE, warning = FALSE, echo=FALSE,fig.height=3}
## Land cover type

ggplot(n4s_sp@data,aes(cn)) + geom_bar(aes(fill=er)) +
    labs(fill = "Ecoregion") +
  theme_bw() +
  ggtitle("Ecoregions (TNC)") + 
  theme(plot.title = element_text(size = 10,face = "italic"), # plot themes
                       #legend.title=element_blank(),
                       axis.text=element_text(size=10),
                       panel.border = element_blank(), 
                       panel.grid.major = element_blank(),
                       panel.grid.minor = element_blank())


```

And the following rough land cover types (but categorisations are not great for some systems!):

```{r plots 4, message = FALSE, warning = FALSE, echo=FALSE,fig.height=3}
## Land cover type

ggplot(n4s_sp@data,aes(cn)) + geom_bar(aes(fill=lc)) +
    labs(fill = "Land cover") +
  theme_bw() +
  ggtitle("Land cover (FAO)") + 
  theme(plot.title = element_text(size = 10,face = "italic"), # plot themes
                       #legend.title=element_blank(),
                       axis.text=element_text(size=10),
                       panel.border = element_blank(), 
                       panel.grid.major = element_blank(),
                       panel.grid.minor = element_blank())
```

### Population and poverty
The populations in the 'sub-national' regions (usually one administartive division below national) of our sites according to OPHI:

```{r plots 5, message = FALSE, warning = FALSE, echo=FALSE,fig.height=3}


ggplot(n4s_sp@data, aes(x=cn,y=rgpop)) +
  geom_jitter(width = 0.2, height = 200, aes(colour=rg), size=1,alpha=0.5,pch=16) +
  ylab("Population (thousands)") +
  labs(colour = "Region") +
  theme_bw() +
  guides(colour=guide_legend(ncol=2)) +
    ggtitle("Sub-national regional population (OPHI). \n Points are jittered.") + 
  theme(plot.title = element_text(size = 10,face = "italic"), # plot themes
                       #legend.title=element_blank(),
                       axis.text=element_text(size=10),
                       panel.border = element_blank(), 
                       panel.grid.major = element_blank(),
                       panel.grid.minor = element_blank())

#"rgpop" "cnmpi" "rgmpi" "tt"    "hfp"   "pad"   "lc"    "er"

```

Global multi-dimensional poverty index at the national and sub-national levels are (higher is more poverty):

```{r plots 6, message = FALSE, warning = FALSE, echo=FALSE,fig.height=3}

ggplot(n4s_sp@data, aes(x=cn,y=rgmpi)) +
  geom_jitter(width = 0.2, height = 0.01, aes(colour=rg), size=1,alpha=0.5,pch=16) +
  ylab("Global MPI") +
  geom_point(aes(x=cn,y=cnmpi)) +
  labs(colour = "Region") +
  theme_bw() +
  guides(colour=guide_legend(ncol=2)) +
    ggtitle("Global MPI at national and sub-national levels (OPHI). \n Black points are the national GMPI. Other points are jittered.") + 
  theme(plot.title = element_text(size = 10,face = "italic"), # plot themes
                       #legend.title=element_blank(),
                       axis.text=element_text(size=10),
                       panel.border = element_blank(), 
                       panel.grid.major = element_blank(),
                       panel.grid.minor = element_blank())


```

### Market access
Travel time to the nearest city (as a proxy for market access) is:

```{r plots 7, message = FALSE, warning = FALSE, echo=FALSE,fig.height=3}
ggplot(n4s_sp@data, aes(x=cn,y=tt)) +
  geom_jitter(width = 0.1, height = 0, aes(colour=rg), size=1,alpha=0.5,pch=16) +
  ylab("Travel time (minutes)") +
  labs(colour = "Region") +
  theme_bw() +
  guides(colour=guide_legend(ncol=2)) +
    ggtitle("Travel time to nearest city of 50k.\n Points jittered.") + 
  theme(plot.title = element_text(size = 10,face = "italic"), # plot themes
                       #legend.title=element_blank(),
                       axis.text=element_text(size=10),
                       panel.border = element_blank(), 
                       panel.grid.major = element_blank(),
                       panel.grid.minor = element_blank())

# "tt"    "hfp"   "pad"   "lc"    "er"

```

### Ecological condition
Human footprint index (as a proxy for human pressure on the environment; higher is more pressure) is:

```{r plots 8, message = FALSE, warning = FALSE, echo=FALSE,fig.height=3}
ggplot(n4s_sp@data, aes(x=cn,y=hfp)) +
  geom_jitter(width = 0.1, height = 0, aes(colour=rg), size=1,alpha=0.5,pch=16) +
  ylab("Human Footprint Index") +
  labs(colour = "Region") +
  theme_bw() +
  guides(colour=guide_legend(ncol=2)) +
    ggtitle("Human footprint index.\n Points jittered.") + 
  theme(plot.title = element_text(size = 10,face = "italic"), # plot themes
                       #legend.title=element_blank(),
                       axis.text=element_text(size=10),
                       panel.border = element_blank(), 
                       panel.grid.major = element_blank(),
                       panel.grid.minor = element_blank())

# "tt"    "hfp"   "pad"   "lc"    "er"

```

### Protected areas
And distance to the nearest protected area is as follows (the underlying dataset is not great though!):

```{r plots 9, message = FALSE, warning = FALSE, echo=FALSE,fig.height=3}
ggplot(n4s_sp@data, aes(x=cn,y=pad)) +
  geom_jitter(width = 0.1, height = 0, aes(colour=rg), size=1,alpha=0.5,pch=16) +
  ylab("Kilometres") +
  labs(colour = "Region") +
  theme_bw() +
  guides(colour=guide_legend(ncol=2)) +
    ggtitle("Distance to protected area. \n Points jittered.") + 
  theme(plot.title = element_text(size = 10,face = "italic"), # plot themes
                       #legend.title=element_blank(),
                       axis.text=element_text(size=10),
                       panel.border = element_blank(), 
                       panel.grid.major = element_blank(),
                       panel.grid.minor = element_blank())

```

```{r final stuff, message = FALSE, warning = FALSE, include = FALSE, echo = FALSE}

rgdal::writeOGR(n4s_sp,"../data/proc","n4s_sp", driver="ESRI Shapefile", overwrite_layer = TRUE)

```
